<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Mindra</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="login-container">
    <h1>Iniciar Sesión</h1>

    <input id="email" type="email" placeholder="Correo" required>
    <input id="password" type="password" placeholder="Contraseña" required>

    <button id="login-btn">Iniciar Sesión</button>
    <button id="register-btn" class="secondary">Registrarse</button>

    <p id="error-msg" class="error"></p>
</div>

<script type="module">

/* ------------------------------ FIREBASE ------------------------------ */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
    getAuth, 
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyB4qio3SPPwz6k51YSWQPULfMXbJSblBOU",
  authDomain: "mindra-8f3bb.firebaseapp.com",
  projectId: "mindra-8f3bb",
  storageBucket: "mindra-8f3bb.firebasestorage.app",
  messagingSenderId: "184399274274",
  appId: "1:184399274274:web:324bf3495b03bfc368857b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* ------------------------------ LOGIN ------------------------------ */
document.getElementById("login-btn").addEventListener("click", async () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    try {
        await signInWithEmailAndPassword(auth, email, password);
        window.location.href = "/"; // Ir al chat
    } catch (error) {
        document.getElementById("error-msg").textContent = error.message;
    }
});

/* ------------------------------ REGISTER ------------------------------ */
document.getElementById("register-btn").addEventListener("click", async () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    try {
        await createUserWithEmailAndPassword(auth, email, password);
        window.location.href = "/";
    } catch (error) {
        document.getElementById("error-msg").textContent = error.message;
    }
});

</script>
</body>
</html>
